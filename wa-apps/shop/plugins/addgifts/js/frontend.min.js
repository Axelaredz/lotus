function ShopAddgiftsFrontend(){var o=this,s="addgifts__",d=".js-"+s;o.current_ajax=null,o.base_url="/",o.needUpdateCart=function(){var e=$(".shop_addgifts--order-cart-item");e.length&&(e.addClass("shop_addgifts--loading"),o.current_ajax&&o.current_ajax.abort(),o.current_ajax=$.getJSON(o.base_url+"shop_addgifts_fullcart/",function(e){for(var t in o.current_ajax=null,e.data)$(".shop_addgifts--vid-"+t).replaceWith(e.data[t])}))},$(document).ajaxSuccess(function(e,t,n){t.responseJSON&&"ok"==t.responseJSON.status&&t.responseJSON.data&&t.responseJSON.data.total&&o.needUpdateCart()}),$(document).on("wa_order_cart_changed",function(){o.needUpdateCart()}),$(document).on("click",d+"change_sku",function(e){e.preventDefault(),$(this).closest(d+"gift").find(d+"skus").addClass(s+"skus--open")}),$(document).on("click",d+"skus_close",function(e){e.preventDefault(),$(this).closest(d+"skus").removeClass(s+"skus--open")}),$(document).on("change",d+"select_sku",function(){var e=$(this),t=e.val(),n=s+"sku_vid_"+e.data("vid")+"_r_"+e.data("rule-id")+"_gi_"+e.data("gift-index");o.cookie(n,t);var a=e.closest(d+"gift").find(d+"sku_name");a.html(e.data("sku-name")),a.data("selected-sku-id",t),e.closest(d+"skus").removeClass(s+"skus--open"),e.closest(".shop_addgifts--order-cart-item").length&&o.needUpdateCart()}),o.cookie=function(e,t,n){if(1<arguments.length&&(null===t||"object"!=typeof t)){if(n=jQuery.extend({path:"/",expires:30},n),null===t&&(n.expires=-1),"number"==typeof n.expires){var a=n.expires,o=n.expires=new Date;o.setDate(o.getDate()+a)}return document.cookie=[encodeURIComponent(e),"=",n.raw?String(t):encodeURIComponent(String(t)),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}var s,d=(n=t||{}).raw?function(e){return e}:decodeURIComponent;return(s=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?d(s[1]):null},$(document).ready(function(){$.tooltipster&&$(".js-addgifts__tooltip").tooltipster()})}var shop_addgifts__frontend=new ShopAddgiftsFrontend;